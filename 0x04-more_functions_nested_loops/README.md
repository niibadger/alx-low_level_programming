MORE nested lops and function i guesss